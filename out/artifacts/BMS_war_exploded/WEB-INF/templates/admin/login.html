<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="utf-8">
		<title> 图书管理系统 </title>
		
		<script th:src="@{/js/jquery.min.js}" ></script>
		<script th:src="@{/js/afquery.js}" ></script>
		<link rel="stylesheet" th:href="@{/css/common.css}" />
		<link rel="stylesheet" th:href="@{/css/main.css}" />	
		
		<!-- layer.js 对话框API -->	
		<script th:src="@{/layer/layer.js}" ></script>
		
		<style>
			.header{
				padding: 10px;
				background: linear-gradient(to bottom, lightskyblue, #7dbedc 30%);
				height: 70px;


			}

			.search{
				width: 200px;
				height: 30px;
				position: absolute;
				left: 900px;
				top: 40px;
			}
			.search-icon{
				height: 20px;
				width: 20px;
				position: relative;
				left: 180px;
				top: -25px;
			}
			.user-thumbnail{
				position: absolute;
				left: 1250px;
			}
			.preferredFont{
				font-family: Menlo,Monaco,Consolas,"Courier New",monospace;
				color: #333;
			}
		</style>


	</head>
	<body th:background="@{/img/background.png}">
		<div class='header'>
			<div style="font-size: 24px;line-height:70px;position: absolute;left:200px;font-weight: bold;">图书管理系统</div>
			<div class="search">
				<form >
					<input class="search-info" type="text" placeholder="查询书籍信息"> <img th:src="@{/img/search.png}" onclick="my.search()" class="search-icon">
				</form>
			</div>
<!--			用户头像-->
			<div class="user-thumbnail">
				<img th:src="@{/img/user.jpg}" style="width: 50px;height: 50px;border-radius:50%">
				<span style="position: relative;left: -53px;top:17px;font-family: Arial" class="preferredFont">未登录</span>
			</div>

		</div>
		<div class="loginContainer center " >
			<div class='form' style='padding: 40px;'>
				<div class='pad' style='margin-bottom: 30px;font-size:110%'>
					Admin 账 号 密 码 登 录
				</div>
				<div class='pad'>
					<input class='username' type='text' placeholder="账号">
				</div>
				<div class='pad'>
					<input class='password' type='password' placeholder="密码">
				</div>
				<div class="pad" style="height: 35px;">
					<img th:src="@{/code}" th:id="identity"  style="width:100px;">
					<input type="button"  value="更换验证码" onclick="my.change()" id="btn"
						   style="font-size: 14px;position: relative;top: -7px" >
				</div>
				<div class="pad" style="position: relative;left: 17px">
					<input class="code" type="text" placeholder="请输入验证码">
					<input type="button" value="验证" onclick="my.verify()"
						   style="font-size: 14px;position: relative;left: -43px">
				</div>
				<div class='pad' >
					<button class='primary' onclick='my.login()'> 登  录 </button>
				</div>				
			</div>

		</div>	

	</body>
	
	<script>
		var my = {};
		var isrigh=false;
		my.login = function(){
			if(isrigh==true) {
				var req = {};
				req.username = $('.form .username').val().trim();
				req.password = $('.form .password').val().trim();

				Af.rest('[[@{/admin/login.do}]]', req, function (data) {
					layer.msg('成功', {
						time: 1000,
						end: function () {
							location.href = '[[@{/admin/info}]]';
						}
					})
				})
			}
			else {
				layer.msg ('请输入验证码',{
					time:1000,
					end:function (){

					}
				}
				)
			}

		}
		my.change=function ()
		{
			var des='[[@{/code}]]';
			document.getElementById('identity').src=des+"?ts="+new Date().getTime();

		}
		my.verify= function ()
		{
			var req = {};
			req.code = $('.form .code').val().trim();
			Af.rest('[[@{/code.do}]]', req, function(data){
				layer.msg ('正确',{
					time:1000,
					end: function(){
						isrigh=true;

					}
				})
			},function (data1,data2){
				layer.msg ('验证错误',{
					time:1000,
					end: function(){
						isrigh=false;
						my.change();
					}
				})
			})
		}
		my.search=function ()
		{
			var req={};

			req.keyWord=$('.search .search-info').val().trim();
			alert(req.keyWord);
			Af.rest('[[@{/book/search}]]', req, function(data){
				location.href='[[@{/book/list}]]';
			}
			)
		}
	</script>
</html>
